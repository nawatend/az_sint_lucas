{"ast":null,"code":"/**\n * mux.js\n *\n * Copyright (c) Brightcove\n * Licensed Apache-2.0 https://github.com/videojs/mux.js/blob/master/LICENSE\n *\n * Parse the internal MP4 structure into an equivalent javascript\n * object.\n */\n'use strict';\n\nvar inspectMp4,\n    textifyMp4,\n    parseType = require('../mp4/probe').parseType,\n    parseMp4Date = function (seconds) {\n  return new Date(seconds * 1000 - 2082844800000);\n},\n    parseSampleFlags = function (flags) {\n  return {\n    isLeading: (flags[0] & 0x0c) >>> 2,\n    dependsOn: flags[0] & 0x03,\n    isDependedOn: (flags[1] & 0xc0) >>> 6,\n    hasRedundancy: (flags[1] & 0x30) >>> 4,\n    paddingValue: (flags[1] & 0x0e) >>> 1,\n    isNonSyncSample: flags[1] & 0x01,\n    degradationPriority: flags[2] << 8 | flags[3]\n  };\n},\n    nalParse = function (avcStream) {\n  var avcView = new DataView(avcStream.buffer, avcStream.byteOffset, avcStream.byteLength),\n      result = [],\n      i,\n      length;\n\n  for (i = 0; i + 4 < avcStream.length; i += length) {\n    length = avcView.getUint32(i);\n    i += 4; // bail if this doesn't appear to be an H264 stream\n\n    if (length <= 0) {\n      result.push('<span style=\\'color:red;\\'>MALFORMED DATA</span>');\n      continue;\n    }\n\n    switch (avcStream[i] & 0x1F) {\n      case 0x01:\n        result.push('slice_layer_without_partitioning_rbsp');\n        break;\n\n      case 0x05:\n        result.push('slice_layer_without_partitioning_rbsp_idr');\n        break;\n\n      case 0x06:\n        result.push('sei_rbsp');\n        break;\n\n      case 0x07:\n        result.push('seq_parameter_set_rbsp');\n        break;\n\n      case 0x08:\n        result.push('pic_parameter_set_rbsp');\n        break;\n\n      case 0x09:\n        result.push('access_unit_delimiter_rbsp');\n        break;\n\n      default:\n        result.push('UNKNOWN NAL - ' + avcStream[i] & 0x1F);\n        break;\n    }\n  }\n\n  return result;\n},\n    // registry of handlers for individual mp4 box types\nparse = {\n  // codingname, not a first-class box type. stsd entries share the\n  // same format as real boxes so the parsing infrastructure can be\n  // shared\n  avc1: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n    return {\n      dataReferenceIndex: view.getUint16(6),\n      width: view.getUint16(24),\n      height: view.getUint16(26),\n      horizresolution: view.getUint16(28) + view.getUint16(30) / 16,\n      vertresolution: view.getUint16(32) + view.getUint16(34) / 16,\n      frameCount: view.getUint16(40),\n      depth: view.getUint16(74),\n      config: inspectMp4(data.subarray(78, data.byteLength))\n    };\n  },\n  avcC: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n      configurationVersion: data[0],\n      avcProfileIndication: data[1],\n      profileCompatibility: data[2],\n      avcLevelIndication: data[3],\n      lengthSizeMinusOne: data[4] & 0x03,\n      sps: [],\n      pps: []\n    },\n        numOfSequenceParameterSets = data[5] & 0x1f,\n        numOfPictureParameterSets,\n        nalSize,\n        offset,\n        i; // iterate past any SPSs\n\n    offset = 6;\n\n    for (i = 0; i < numOfSequenceParameterSets; i++) {\n      nalSize = view.getUint16(offset);\n      offset += 2;\n      result.sps.push(new Uint8Array(data.subarray(offset, offset + nalSize)));\n      offset += nalSize;\n    } // iterate past any PPSs\n\n\n    numOfPictureParameterSets = data[offset];\n    offset++;\n\n    for (i = 0; i < numOfPictureParameterSets; i++) {\n      nalSize = view.getUint16(offset);\n      offset += 2;\n      result.pps.push(new Uint8Array(data.subarray(offset, offset + nalSize)));\n      offset += nalSize;\n    }\n\n    return result;\n  },\n  btrt: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n    return {\n      bufferSizeDB: view.getUint32(0),\n      maxBitrate: view.getUint32(4),\n      avgBitrate: view.getUint32(8)\n    };\n  },\n  esds: function (data) {\n    return {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      esId: data[6] << 8 | data[7],\n      streamPriority: data[8] & 0x1f,\n      decoderConfig: {\n        objectProfileIndication: data[11],\n        streamType: data[12] >>> 2 & 0x3f,\n        bufferSize: data[13] << 16 | data[14] << 8 | data[15],\n        maxBitrate: data[16] << 24 | data[17] << 16 | data[18] << 8 | data[19],\n        avgBitrate: data[20] << 24 | data[21] << 16 | data[22] << 8 | data[23],\n        decoderConfigDescriptor: {\n          tag: data[24],\n          length: data[25],\n          audioObjectType: data[26] >>> 3 & 0x1f,\n          samplingFrequencyIndex: (data[26] & 0x07) << 1 | data[27] >>> 7 & 0x01,\n          channelConfiguration: data[27] >>> 3 & 0x0f\n        }\n      }\n    };\n  },\n  ftyp: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n      majorBrand: parseType(data.subarray(0, 4)),\n      minorVersion: view.getUint32(4),\n      compatibleBrands: []\n    },\n        i = 8;\n\n    while (i < data.byteLength) {\n      result.compatibleBrands.push(parseType(data.subarray(i, i + 4)));\n      i += 4;\n    }\n\n    return result;\n  },\n  dinf: function (data) {\n    return {\n      boxes: inspectMp4(data)\n    };\n  },\n  dref: function (data) {\n    return {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      dataReferences: inspectMp4(data.subarray(8))\n    };\n  },\n  hdlr: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n      version: view.getUint8(0),\n      flags: new Uint8Array(data.subarray(1, 4)),\n      handlerType: parseType(data.subarray(8, 12)),\n      name: ''\n    },\n        i = 8; // parse out the name field\n\n    for (i = 24; i < data.byteLength; i++) {\n      if (data[i] === 0x00) {\n        // the name field is null-terminated\n        i++;\n        break;\n      }\n\n      result.name += String.fromCharCode(data[i]);\n    } // decode UTF-8 to javascript's internal representation\n    // see http://ecmanaut.blogspot.com/2006/07/encoding-decoding-utf8-in-javascript.html\n\n\n    result.name = decodeURIComponent(escape(result.name));\n    return result;\n  },\n  mdat: function (data) {\n    return {\n      byteLength: data.byteLength,\n      nals: nalParse(data)\n    };\n  },\n  mdhd: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        i = 4,\n        language,\n        result = {\n      version: view.getUint8(0),\n      flags: new Uint8Array(data.subarray(1, 4)),\n      language: ''\n    };\n\n    if (result.version === 1) {\n      i += 4;\n      result.creationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n\n      i += 8;\n      result.modificationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n\n      i += 4;\n      result.timescale = view.getUint32(i);\n      i += 8;\n      result.duration = view.getUint32(i); // truncating top 4 bytes\n    } else {\n      result.creationTime = parseMp4Date(view.getUint32(i));\n      i += 4;\n      result.modificationTime = parseMp4Date(view.getUint32(i));\n      i += 4;\n      result.timescale = view.getUint32(i);\n      i += 4;\n      result.duration = view.getUint32(i);\n    }\n\n    i += 4; // language is stored as an ISO-639-2/T code in an array of three 5-bit fields\n    // each field is the packed difference between its ASCII value and 0x60\n\n    language = view.getUint16(i);\n    result.language += String.fromCharCode((language >> 10) + 0x60);\n    result.language += String.fromCharCode(((language & 0x03e0) >> 5) + 0x60);\n    result.language += String.fromCharCode((language & 0x1f) + 0x60);\n    return result;\n  },\n  mdia: function (data) {\n    return {\n      boxes: inspectMp4(data)\n    };\n  },\n  mfhd: function (data) {\n    return {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      sequenceNumber: data[4] << 24 | data[5] << 16 | data[6] << 8 | data[7]\n    };\n  },\n  minf: function (data) {\n    return {\n      boxes: inspectMp4(data)\n    };\n  },\n  // codingname, not a first-class box type. stsd entries share the\n  // same format as real boxes so the parsing infrastructure can be\n  // shared\n  mp4a: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n      // 6 bytes reserved\n      dataReferenceIndex: view.getUint16(6),\n      // 4 + 4 bytes reserved\n      channelcount: view.getUint16(16),\n      samplesize: view.getUint16(18),\n      // 2 bytes pre_defined\n      // 2 bytes reserved\n      samplerate: view.getUint16(24) + view.getUint16(26) / 65536\n    }; // if there are more bytes to process, assume this is an ISO/IEC\n    // 14496-14 MP4AudioSampleEntry and parse the ESDBox\n\n    if (data.byteLength > 28) {\n      result.streamDescriptor = inspectMp4(data.subarray(28))[0];\n    }\n\n    return result;\n  },\n  moof: function (data) {\n    return {\n      boxes: inspectMp4(data)\n    };\n  },\n  moov: function (data) {\n    return {\n      boxes: inspectMp4(data)\n    };\n  },\n  mvex: function (data) {\n    return {\n      boxes: inspectMp4(data)\n    };\n  },\n  mvhd: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        i = 4,\n        result = {\n      version: view.getUint8(0),\n      flags: new Uint8Array(data.subarray(1, 4))\n    };\n\n    if (result.version === 1) {\n      i += 4;\n      result.creationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n\n      i += 8;\n      result.modificationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n\n      i += 4;\n      result.timescale = view.getUint32(i);\n      i += 8;\n      result.duration = view.getUint32(i); // truncating top 4 bytes\n    } else {\n      result.creationTime = parseMp4Date(view.getUint32(i));\n      i += 4;\n      result.modificationTime = parseMp4Date(view.getUint32(i));\n      i += 4;\n      result.timescale = view.getUint32(i);\n      i += 4;\n      result.duration = view.getUint32(i);\n    }\n\n    i += 4; // convert fixed-point, base 16 back to a number\n\n    result.rate = view.getUint16(i) + view.getUint16(i + 2) / 16;\n    i += 4;\n    result.volume = view.getUint8(i) + view.getUint8(i + 1) / 8;\n    i += 2;\n    i += 2;\n    i += 2 * 4;\n    result.matrix = new Uint32Array(data.subarray(i, i + 9 * 4));\n    i += 9 * 4;\n    i += 6 * 4;\n    result.nextTrackId = view.getUint32(i);\n    return result;\n  },\n  pdin: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n    return {\n      version: view.getUint8(0),\n      flags: new Uint8Array(data.subarray(1, 4)),\n      rate: view.getUint32(4),\n      initialDelay: view.getUint32(8)\n    };\n  },\n  sdtp: function (data) {\n    var result = {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      samples: []\n    },\n        i;\n\n    for (i = 4; i < data.byteLength; i++) {\n      result.samples.push({\n        dependsOn: (data[i] & 0x30) >> 4,\n        isDependedOn: (data[i] & 0x0c) >> 2,\n        hasRedundancy: data[i] & 0x03\n      });\n    }\n\n    return result;\n  },\n  sidx: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      references: [],\n      referenceId: view.getUint32(4),\n      timescale: view.getUint32(8),\n      earliestPresentationTime: view.getUint32(12),\n      firstOffset: view.getUint32(16)\n    },\n        referenceCount = view.getUint16(22),\n        i;\n\n    for (i = 24; referenceCount; i += 12, referenceCount--) {\n      result.references.push({\n        referenceType: (data[i] & 0x80) >>> 7,\n        referencedSize: view.getUint32(i) & 0x7FFFFFFF,\n        subsegmentDuration: view.getUint32(i + 4),\n        startsWithSap: !!(data[i + 8] & 0x80),\n        sapType: (data[i + 8] & 0x70) >>> 4,\n        sapDeltaTime: view.getUint32(i + 8) & 0x0FFFFFFF\n      });\n    }\n\n    return result;\n  },\n  smhd: function (data) {\n    return {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      balance: data[4] + data[5] / 256\n    };\n  },\n  stbl: function (data) {\n    return {\n      boxes: inspectMp4(data)\n    };\n  },\n  stco: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      chunkOffsets: []\n    },\n        entryCount = view.getUint32(4),\n        i;\n\n    for (i = 8; entryCount; i += 4, entryCount--) {\n      result.chunkOffsets.push(view.getUint32(i));\n    }\n\n    return result;\n  },\n  stsc: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        entryCount = view.getUint32(4),\n        result = {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      sampleToChunks: []\n    },\n        i;\n\n    for (i = 8; entryCount; i += 12, entryCount--) {\n      result.sampleToChunks.push({\n        firstChunk: view.getUint32(i),\n        samplesPerChunk: view.getUint32(i + 4),\n        sampleDescriptionIndex: view.getUint32(i + 8)\n      });\n    }\n\n    return result;\n  },\n  stsd: function (data) {\n    return {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      sampleDescriptions: inspectMp4(data.subarray(8))\n    };\n  },\n  stsz: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      sampleSize: view.getUint32(4),\n      entries: []\n    },\n        i;\n\n    for (i = 12; i < data.byteLength; i += 4) {\n      result.entries.push(view.getUint32(i));\n    }\n\n    return result;\n  },\n  stts: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      timeToSamples: []\n    },\n        entryCount = view.getUint32(4),\n        i;\n\n    for (i = 8; entryCount; i += 8, entryCount--) {\n      result.timeToSamples.push({\n        sampleCount: view.getUint32(i),\n        sampleDelta: view.getUint32(i + 4)\n      });\n    }\n\n    return result;\n  },\n  styp: function (data) {\n    return parse.ftyp(data);\n  },\n  tfdt: function (data) {\n    var result = {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      baseMediaDecodeTime: data[4] << 24 | data[5] << 16 | data[6] << 8 | data[7]\n    };\n\n    if (result.version === 1) {\n      result.baseMediaDecodeTime *= Math.pow(2, 32);\n      result.baseMediaDecodeTime += data[8] << 24 | data[9] << 16 | data[10] << 8 | data[11];\n    }\n\n    return result;\n  },\n  tfhd: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      trackId: view.getUint32(4)\n    },\n        baseDataOffsetPresent = result.flags[2] & 0x01,\n        sampleDescriptionIndexPresent = result.flags[2] & 0x02,\n        defaultSampleDurationPresent = result.flags[2] & 0x08,\n        defaultSampleSizePresent = result.flags[2] & 0x10,\n        defaultSampleFlagsPresent = result.flags[2] & 0x20,\n        durationIsEmpty = result.flags[0] & 0x010000,\n        defaultBaseIsMoof = result.flags[0] & 0x020000,\n        i;\n    i = 8;\n\n    if (baseDataOffsetPresent) {\n      i += 4; // truncate top 4 bytes\n      // FIXME: should we read the full 64 bits?\n\n      result.baseDataOffset = view.getUint32(12);\n      i += 4;\n    }\n\n    if (sampleDescriptionIndexPresent) {\n      result.sampleDescriptionIndex = view.getUint32(i);\n      i += 4;\n    }\n\n    if (defaultSampleDurationPresent) {\n      result.defaultSampleDuration = view.getUint32(i);\n      i += 4;\n    }\n\n    if (defaultSampleSizePresent) {\n      result.defaultSampleSize = view.getUint32(i);\n      i += 4;\n    }\n\n    if (defaultSampleFlagsPresent) {\n      result.defaultSampleFlags = view.getUint32(i);\n    }\n\n    if (durationIsEmpty) {\n      result.durationIsEmpty = true;\n    }\n\n    if (!baseDataOffsetPresent && defaultBaseIsMoof) {\n      result.baseDataOffsetIsMoof = true;\n    }\n\n    return result;\n  },\n  tkhd: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        i = 4,\n        result = {\n      version: view.getUint8(0),\n      flags: new Uint8Array(data.subarray(1, 4))\n    };\n\n    if (result.version === 1) {\n      i += 4;\n      result.creationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n\n      i += 8;\n      result.modificationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n\n      i += 4;\n      result.trackId = view.getUint32(i);\n      i += 4;\n      i += 8;\n      result.duration = view.getUint32(i); // truncating top 4 bytes\n    } else {\n      result.creationTime = parseMp4Date(view.getUint32(i));\n      i += 4;\n      result.modificationTime = parseMp4Date(view.getUint32(i));\n      i += 4;\n      result.trackId = view.getUint32(i);\n      i += 4;\n      i += 4;\n      result.duration = view.getUint32(i);\n    }\n\n    i += 4;\n    i += 2 * 4;\n    result.layer = view.getUint16(i);\n    i += 2;\n    result.alternateGroup = view.getUint16(i);\n    i += 2; // convert fixed-point, base 16 back to a number\n\n    result.volume = view.getUint8(i) + view.getUint8(i + 1) / 8;\n    i += 2;\n    i += 2;\n    result.matrix = new Uint32Array(data.subarray(i, i + 9 * 4));\n    i += 9 * 4;\n    result.width = view.getUint16(i) + view.getUint16(i + 2) / 16;\n    i += 4;\n    result.height = view.getUint16(i) + view.getUint16(i + 2) / 16;\n    return result;\n  },\n  traf: function (data) {\n    return {\n      boxes: inspectMp4(data)\n    };\n  },\n  trak: function (data) {\n    return {\n      boxes: inspectMp4(data)\n    };\n  },\n  trex: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n    return {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      trackId: view.getUint32(4),\n      defaultSampleDescriptionIndex: view.getUint32(8),\n      defaultSampleDuration: view.getUint32(12),\n      defaultSampleSize: view.getUint32(16),\n      sampleDependsOn: data[20] & 0x03,\n      sampleIsDependedOn: (data[21] & 0xc0) >> 6,\n      sampleHasRedundancy: (data[21] & 0x30) >> 4,\n      samplePaddingValue: (data[21] & 0x0e) >> 1,\n      sampleIsDifferenceSample: !!(data[21] & 0x01),\n      sampleDegradationPriority: view.getUint16(22)\n    };\n  },\n  trun: function (data) {\n    var result = {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      samples: []\n    },\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        // Flag interpretation\n    dataOffsetPresent = result.flags[2] & 0x01,\n        // compare with 2nd byte of 0x1\n    firstSampleFlagsPresent = result.flags[2] & 0x04,\n        // compare with 2nd byte of 0x4\n    sampleDurationPresent = result.flags[1] & 0x01,\n        // compare with 2nd byte of 0x100\n    sampleSizePresent = result.flags[1] & 0x02,\n        // compare with 2nd byte of 0x200\n    sampleFlagsPresent = result.flags[1] & 0x04,\n        // compare with 2nd byte of 0x400\n    sampleCompositionTimeOffsetPresent = result.flags[1] & 0x08,\n        // compare with 2nd byte of 0x800\n    sampleCount = view.getUint32(4),\n        offset = 8,\n        sample;\n\n    if (dataOffsetPresent) {\n      // 32 bit signed integer\n      result.dataOffset = view.getInt32(offset);\n      offset += 4;\n    } // Overrides the flags for the first sample only. The order of\n    // optional values will be: duration, size, compositionTimeOffset\n\n\n    if (firstSampleFlagsPresent && sampleCount) {\n      sample = {\n        flags: parseSampleFlags(data.subarray(offset, offset + 4))\n      };\n      offset += 4;\n\n      if (sampleDurationPresent) {\n        sample.duration = view.getUint32(offset);\n        offset += 4;\n      }\n\n      if (sampleSizePresent) {\n        sample.size = view.getUint32(offset);\n        offset += 4;\n      }\n\n      if (sampleCompositionTimeOffsetPresent) {\n        // Note: this should be a signed int if version is 1\n        sample.compositionTimeOffset = view.getUint32(offset);\n        offset += 4;\n      }\n\n      result.samples.push(sample);\n      sampleCount--;\n    }\n\n    while (sampleCount--) {\n      sample = {};\n\n      if (sampleDurationPresent) {\n        sample.duration = view.getUint32(offset);\n        offset += 4;\n      }\n\n      if (sampleSizePresent) {\n        sample.size = view.getUint32(offset);\n        offset += 4;\n      }\n\n      if (sampleFlagsPresent) {\n        sample.flags = parseSampleFlags(data.subarray(offset, offset + 4));\n        offset += 4;\n      }\n\n      if (sampleCompositionTimeOffsetPresent) {\n        // Note: this should be a signed int if version is 1\n        sample.compositionTimeOffset = view.getUint32(offset);\n        offset += 4;\n      }\n\n      result.samples.push(sample);\n    }\n\n    return result;\n  },\n  'url ': function (data) {\n    return {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4))\n    };\n  },\n  vmhd: function (data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n    return {\n      version: data[0],\n      flags: new Uint8Array(data.subarray(1, 4)),\n      graphicsmode: view.getUint16(4),\n      opcolor: new Uint16Array([view.getUint16(6), view.getUint16(8), view.getUint16(10)])\n    };\n  }\n};\n/**\n * Return a javascript array of box objects parsed from an ISO base\n * media file.\n * @param data {Uint8Array} the binary data of the media to be inspected\n * @return {array} a javascript array of potentially nested box objects\n */\n\n\ninspectMp4 = function (data) {\n  var i = 0,\n      result = [],\n      view,\n      size,\n      type,\n      end,\n      box; // Convert data from Uint8Array to ArrayBuffer, to follow Dataview API\n\n  var ab = new ArrayBuffer(data.length);\n  var v = new Uint8Array(ab);\n\n  for (var z = 0; z < data.length; ++z) {\n    v[z] = data[z];\n  }\n\n  view = new DataView(ab);\n\n  while (i < data.byteLength) {\n    // parse box data\n    size = view.getUint32(i);\n    type = parseType(data.subarray(i + 4, i + 8));\n    end = size > 1 ? i + size : data.byteLength; // parse type-specific data\n\n    box = (parse[type] || function (data) {\n      return {\n        data: data\n      };\n    })(data.subarray(i + 8, end));\n\n    box.size = size;\n    box.type = type; // store this box and move to the next\n\n    result.push(box);\n    i = end;\n  }\n\n  return result;\n};\n/**\n * Returns a textual representation of the javascript represtentation\n * of an MP4 file. You can use it as an alternative to\n * JSON.stringify() to compare inspected MP4s.\n * @param inspectedMp4 {array} the parsed array of boxes in an MP4\n * file\n * @param depth {number} (optional) the number of ancestor boxes of\n * the elements of inspectedMp4. Assumed to be zero if unspecified.\n * @return {string} a text representation of the parsed MP4\n */\n\n\ntextifyMp4 = function (inspectedMp4, depth) {\n  var indent;\n  depth = depth || 0;\n  indent = new Array(depth * 2 + 1).join(' '); // iterate over all the boxes\n\n  return inspectedMp4.map(function (box, index) {\n    // list the box type first at the current indentation level\n    return indent + box.type + '\\n' + // the type is already included and handle child boxes separately\n    Object.keys(box).filter(function (key) {\n      return key !== 'type' && key !== 'boxes'; // output all the box properties\n    }).map(function (key) {\n      var prefix = indent + '  ' + key + ': ',\n          value = box[key]; // print out raw bytes as hexademical\n\n      if (value instanceof Uint8Array || value instanceof Uint32Array) {\n        var bytes = Array.prototype.slice.call(new Uint8Array(value.buffer, value.byteOffset, value.byteLength)).map(function (byte) {\n          return ' ' + ('00' + byte.toString(16)).slice(-2);\n        }).join('').match(/.{1,24}/g);\n\n        if (!bytes) {\n          return prefix + '<>';\n        }\n\n        if (bytes.length === 1) {\n          return prefix + '<' + bytes.join('').slice(1) + '>';\n        }\n\n        return prefix + '<\\n' + bytes.map(function (line) {\n          return indent + '  ' + line;\n        }).join('\\n') + '\\n' + indent + '  >';\n      } // stringify generic objects\n\n\n      return prefix + JSON.stringify(value, null, 2).split('\\n').map(function (line, index) {\n        if (index === 0) {\n          return line;\n        }\n\n        return indent + '  ' + line;\n      }).join('\\n');\n    }).join('\\n') + ( // recursively textify the child boxes\n    box.boxes ? '\\n' + textifyMp4(box.boxes, depth + 1) : '');\n  }).join('\\n');\n};\n\nmodule.exports = {\n  inspect: inspectMp4,\n  textify: textifyMp4,\n  parseTfdt: parse.tfdt,\n  parseHdlr: parse.hdlr,\n  parseTfhd: parse.tfhd,\n  parseTrun: parse.trun,\n  parseSidx: parse.sidx\n};","map":{"version":3,"sources":["/Users/quintenleysen/Documents/AZ_SINT_LUCAS/az_sint_lucas/client/node_modules/mux.js/lib/tools/mp4-inspector.js"],"names":["inspectMp4","textifyMp4","parseType","require","parseMp4Date","seconds","Date","parseSampleFlags","flags","isLeading","dependsOn","isDependedOn","hasRedundancy","paddingValue","isNonSyncSample","degradationPriority","nalParse","avcStream","avcView","DataView","buffer","byteOffset","byteLength","result","i","length","getUint32","push","parse","avc1","data","view","dataReferenceIndex","getUint16","width","height","horizresolution","vertresolution","frameCount","depth","config","subarray","avcC","configurationVersion","avcProfileIndication","profileCompatibility","avcLevelIndication","lengthSizeMinusOne","sps","pps","numOfSequenceParameterSets","numOfPictureParameterSets","nalSize","offset","Uint8Array","btrt","bufferSizeDB","maxBitrate","avgBitrate","esds","version","esId","streamPriority","decoderConfig","objectProfileIndication","streamType","bufferSize","decoderConfigDescriptor","tag","audioObjectType","samplingFrequencyIndex","channelConfiguration","ftyp","majorBrand","minorVersion","compatibleBrands","dinf","boxes","dref","dataReferences","hdlr","getUint8","handlerType","name","String","fromCharCode","decodeURIComponent","escape","mdat","nals","mdhd","language","creationTime","modificationTime","timescale","duration","mdia","mfhd","sequenceNumber","minf","mp4a","channelcount","samplesize","samplerate","streamDescriptor","moof","moov","mvex","mvhd","rate","volume","matrix","Uint32Array","nextTrackId","pdin","initialDelay","sdtp","samples","sidx","references","referenceId","earliestPresentationTime","firstOffset","referenceCount","referenceType","referencedSize","subsegmentDuration","startsWithSap","sapType","sapDeltaTime","smhd","balance","stbl","stco","chunkOffsets","entryCount","stsc","sampleToChunks","firstChunk","samplesPerChunk","sampleDescriptionIndex","stsd","sampleDescriptions","stsz","sampleSize","entries","stts","timeToSamples","sampleCount","sampleDelta","styp","tfdt","baseMediaDecodeTime","Math","pow","tfhd","trackId","baseDataOffsetPresent","sampleDescriptionIndexPresent","defaultSampleDurationPresent","defaultSampleSizePresent","defaultSampleFlagsPresent","durationIsEmpty","defaultBaseIsMoof","baseDataOffset","defaultSampleDuration","defaultSampleSize","defaultSampleFlags","baseDataOffsetIsMoof","tkhd","layer","alternateGroup","traf","trak","trex","defaultSampleDescriptionIndex","sampleDependsOn","sampleIsDependedOn","sampleHasRedundancy","samplePaddingValue","sampleIsDifferenceSample","sampleDegradationPriority","trun","dataOffsetPresent","firstSampleFlagsPresent","sampleDurationPresent","sampleSizePresent","sampleFlagsPresent","sampleCompositionTimeOffsetPresent","sample","dataOffset","getInt32","size","compositionTimeOffset","vmhd","graphicsmode","opcolor","Uint16Array","type","end","box","ab","ArrayBuffer","v","z","inspectedMp4","indent","Array","join","map","index","Object","keys","filter","key","prefix","value","bytes","prototype","slice","call","byte","toString","match","line","JSON","stringify","split","module","exports","inspect","textify","parseTfdt","parseHdlr","parseTfhd","parseTrun","parseSidx"],"mappings":"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","sourcesContent":["/**\n * mux.js\n *\n * Copyright (c) Brightcove\n * Licensed Apache-2.0 https://github.com/videojs/mux.js/blob/master/LICENSE\n *\n * Parse the internal MP4 structure into an equivalent javascript\n * object.\n */\n'use strict';\n\nvar\n  inspectMp4,\n  textifyMp4,\n\n  parseType = require('../mp4/probe').parseType,\n  parseMp4Date = function(seconds) {\n    return new Date(seconds * 1000 - 2082844800000);\n  },\n  parseSampleFlags = function(flags) {\n    return {\n      isLeading: (flags[0] & 0x0c) >>> 2,\n      dependsOn: flags[0] & 0x03,\n      isDependedOn: (flags[1] & 0xc0) >>> 6,\n      hasRedundancy: (flags[1] & 0x30) >>> 4,\n      paddingValue: (flags[1] & 0x0e) >>> 1,\n      isNonSyncSample: flags[1] & 0x01,\n      degradationPriority: (flags[2] << 8) | flags[3]\n    };\n  },\n  nalParse = function(avcStream) {\n    var\n      avcView = new DataView(avcStream.buffer, avcStream.byteOffset, avcStream.byteLength),\n      result = [],\n      i,\n      length;\n    for (i = 0; i + 4 < avcStream.length; i += length) {\n      length = avcView.getUint32(i);\n      i += 4;\n\n      // bail if this doesn't appear to be an H264 stream\n      if (length <= 0) {\n        result.push('<span style=\\'color:red;\\'>MALFORMED DATA</span>');\n        continue;\n      }\n\n      switch (avcStream[i] & 0x1F) {\n      case 0x01:\n        result.push('slice_layer_without_partitioning_rbsp');\n        break;\n      case 0x05:\n        result.push('slice_layer_without_partitioning_rbsp_idr');\n        break;\n      case 0x06:\n        result.push('sei_rbsp');\n        break;\n      case 0x07:\n        result.push('seq_parameter_set_rbsp');\n        break;\n      case 0x08:\n        result.push('pic_parameter_set_rbsp');\n        break;\n      case 0x09:\n        result.push('access_unit_delimiter_rbsp');\n        break;\n      default:\n        result.push('UNKNOWN NAL - ' + avcStream[i] & 0x1F);\n        break;\n      }\n    }\n    return result;\n  },\n\n  // registry of handlers for individual mp4 box types\n  parse = {\n    // codingname, not a first-class box type. stsd entries share the\n    // same format as real boxes so the parsing infrastructure can be\n    // shared\n    avc1: function(data) {\n      var view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n      return {\n        dataReferenceIndex: view.getUint16(6),\n        width: view.getUint16(24),\n        height: view.getUint16(26),\n        horizresolution: view.getUint16(28) + (view.getUint16(30) / 16),\n        vertresolution: view.getUint16(32) + (view.getUint16(34) / 16),\n        frameCount: view.getUint16(40),\n        depth: view.getUint16(74),\n        config: inspectMp4(data.subarray(78, data.byteLength))\n      };\n    },\n    avcC: function(data) {\n      var\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n          configurationVersion: data[0],\n          avcProfileIndication: data[1],\n          profileCompatibility: data[2],\n          avcLevelIndication: data[3],\n          lengthSizeMinusOne: data[4] & 0x03,\n          sps: [],\n          pps: []\n        },\n        numOfSequenceParameterSets = data[5] & 0x1f,\n        numOfPictureParameterSets,\n        nalSize,\n        offset,\n        i;\n\n      // iterate past any SPSs\n      offset = 6;\n      for (i = 0; i < numOfSequenceParameterSets; i++) {\n        nalSize = view.getUint16(offset);\n        offset += 2;\n        result.sps.push(new Uint8Array(data.subarray(offset, offset + nalSize)));\n        offset += nalSize;\n      }\n      // iterate past any PPSs\n      numOfPictureParameterSets = data[offset];\n      offset++;\n      for (i = 0; i < numOfPictureParameterSets; i++) {\n        nalSize = view.getUint16(offset);\n        offset += 2;\n        result.pps.push(new Uint8Array(data.subarray(offset, offset + nalSize)));\n        offset += nalSize;\n      }\n      return result;\n    },\n    btrt: function(data) {\n      var view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n      return {\n        bufferSizeDB: view.getUint32(0),\n        maxBitrate: view.getUint32(4),\n        avgBitrate: view.getUint32(8)\n      };\n    },\n    esds: function(data) {\n      return {\n        version: data[0],\n        flags: new Uint8Array(data.subarray(1, 4)),\n        esId: (data[6] << 8) | data[7],\n        streamPriority: data[8] & 0x1f,\n        decoderConfig: {\n          objectProfileIndication: data[11],\n          streamType: (data[12] >>> 2) & 0x3f,\n          bufferSize: (data[13] << 16) | (data[14] << 8) | data[15],\n          maxBitrate: (data[16] << 24) |\n            (data[17] << 16) |\n            (data[18] <<  8) |\n            data[19],\n          avgBitrate: (data[20] << 24) |\n            (data[21] << 16) |\n            (data[22] <<  8) |\n            data[23],\n          decoderConfigDescriptor: {\n            tag: data[24],\n            length: data[25],\n            audioObjectType: (data[26] >>> 3) & 0x1f,\n            samplingFrequencyIndex: ((data[26] & 0x07) << 1) |\n              ((data[27] >>> 7) & 0x01),\n            channelConfiguration: (data[27] >>> 3) & 0x0f\n          }\n        }\n      };\n    },\n    ftyp: function(data) {\n      var\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n          majorBrand: parseType(data.subarray(0, 4)),\n          minorVersion: view.getUint32(4),\n          compatibleBrands: []\n        },\n        i = 8;\n      while (i < data.byteLength) {\n        result.compatibleBrands.push(parseType(data.subarray(i, i + 4)));\n        i += 4;\n      }\n      return result;\n    },\n    dinf: function(data) {\n      return {\n        boxes: inspectMp4(data)\n      };\n    },\n    dref: function(data) {\n      return {\n        version: data[0],\n        flags: new Uint8Array(data.subarray(1, 4)),\n        dataReferences: inspectMp4(data.subarray(8))\n      };\n    },\n    hdlr: function(data) {\n      var\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n          version: view.getUint8(0),\n          flags: new Uint8Array(data.subarray(1, 4)),\n          handlerType: parseType(data.subarray(8, 12)),\n          name: ''\n        },\n        i = 8;\n\n      // parse out the name field\n      for (i = 24; i < data.byteLength; i++) {\n        if (data[i] === 0x00) {\n          // the name field is null-terminated\n          i++;\n          break;\n        }\n        result.name += String.fromCharCode(data[i]);\n      }\n      // decode UTF-8 to javascript's internal representation\n      // see http://ecmanaut.blogspot.com/2006/07/encoding-decoding-utf8-in-javascript.html\n      result.name = decodeURIComponent(escape(result.name));\n\n      return result;\n    },\n    mdat: function(data) {\n      return {\n        byteLength: data.byteLength,\n        nals: nalParse(data)\n      };\n    },\n    mdhd: function(data) {\n      var\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        i = 4,\n        language,\n        result = {\n          version: view.getUint8(0),\n          flags: new Uint8Array(data.subarray(1, 4)),\n          language: ''\n        };\n      if (result.version === 1) {\n        i += 4;\n        result.creationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n        i += 8;\n        result.modificationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n        i += 4;\n        result.timescale = view.getUint32(i);\n        i += 8;\n        result.duration = view.getUint32(i); // truncating top 4 bytes\n      } else {\n        result.creationTime = parseMp4Date(view.getUint32(i));\n        i += 4;\n        result.modificationTime = parseMp4Date(view.getUint32(i));\n        i += 4;\n        result.timescale = view.getUint32(i);\n        i += 4;\n        result.duration = view.getUint32(i);\n      }\n      i += 4;\n      // language is stored as an ISO-639-2/T code in an array of three 5-bit fields\n      // each field is the packed difference between its ASCII value and 0x60\n      language = view.getUint16(i);\n      result.language += String.fromCharCode((language >> 10) + 0x60);\n      result.language += String.fromCharCode(((language & 0x03e0) >> 5) + 0x60);\n      result.language += String.fromCharCode((language & 0x1f) + 0x60);\n\n      return result;\n    },\n    mdia: function(data) {\n      return {\n        boxes: inspectMp4(data)\n      };\n    },\n    mfhd: function(data) {\n      return {\n        version: data[0],\n        flags: new Uint8Array(data.subarray(1, 4)),\n        sequenceNumber: (data[4] << 24) |\n          (data[5] << 16) |\n          (data[6] << 8) |\n          (data[7])\n      };\n    },\n    minf: function(data) {\n      return {\n        boxes: inspectMp4(data)\n      };\n    },\n    // codingname, not a first-class box type. stsd entries share the\n    // same format as real boxes so the parsing infrastructure can be\n    // shared\n    mp4a: function(data) {\n      var\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n          // 6 bytes reserved\n          dataReferenceIndex: view.getUint16(6),\n          // 4 + 4 bytes reserved\n          channelcount: view.getUint16(16),\n          samplesize: view.getUint16(18),\n          // 2 bytes pre_defined\n          // 2 bytes reserved\n          samplerate: view.getUint16(24) + (view.getUint16(26) / 65536)\n        };\n\n      // if there are more bytes to process, assume this is an ISO/IEC\n      // 14496-14 MP4AudioSampleEntry and parse the ESDBox\n      if (data.byteLength > 28) {\n        result.streamDescriptor = inspectMp4(data.subarray(28))[0];\n      }\n      return result;\n    },\n    moof: function(data) {\n      return {\n        boxes: inspectMp4(data)\n      };\n    },\n    moov: function(data) {\n      return {\n        boxes: inspectMp4(data)\n      };\n    },\n    mvex: function(data) {\n      return {\n        boxes: inspectMp4(data)\n      };\n    },\n    mvhd: function(data) {\n      var\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        i = 4,\n        result = {\n          version: view.getUint8(0),\n          flags: new Uint8Array(data.subarray(1, 4))\n        };\n\n      if (result.version === 1) {\n        i += 4;\n        result.creationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n        i += 8;\n        result.modificationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n        i += 4;\n        result.timescale = view.getUint32(i);\n        i += 8;\n        result.duration = view.getUint32(i); // truncating top 4 bytes\n      } else {\n        result.creationTime = parseMp4Date(view.getUint32(i));\n        i += 4;\n        result.modificationTime = parseMp4Date(view.getUint32(i));\n        i += 4;\n        result.timescale = view.getUint32(i);\n        i += 4;\n        result.duration = view.getUint32(i);\n      }\n      i += 4;\n\n      // convert fixed-point, base 16 back to a number\n      result.rate = view.getUint16(i) + (view.getUint16(i + 2) / 16);\n      i += 4;\n      result.volume = view.getUint8(i) + (view.getUint8(i + 1) / 8);\n      i += 2;\n      i += 2;\n      i += 2 * 4;\n      result.matrix = new Uint32Array(data.subarray(i, i + (9 * 4)));\n      i += 9 * 4;\n      i += 6 * 4;\n      result.nextTrackId = view.getUint32(i);\n      return result;\n    },\n    pdin: function(data) {\n      var view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n      return {\n        version: view.getUint8(0),\n        flags: new Uint8Array(data.subarray(1, 4)),\n        rate: view.getUint32(4),\n        initialDelay: view.getUint32(8)\n      };\n    },\n    sdtp: function(data) {\n      var\n        result = {\n          version: data[0],\n          flags: new Uint8Array(data.subarray(1, 4)),\n          samples: []\n        }, i;\n\n      for (i = 4; i < data.byteLength; i++) {\n        result.samples.push({\n          dependsOn: (data[i] & 0x30) >> 4,\n          isDependedOn: (data[i] & 0x0c) >> 2,\n          hasRedundancy: data[i] & 0x03\n        });\n      }\n      return result;\n    },\n    sidx: function(data) {\n      var view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n          result = {\n            version: data[0],\n            flags: new Uint8Array(data.subarray(1, 4)),\n            references: [],\n            referenceId: view.getUint32(4),\n            timescale: view.getUint32(8),\n            earliestPresentationTime: view.getUint32(12),\n            firstOffset: view.getUint32(16)\n          },\n          referenceCount = view.getUint16(22),\n          i;\n\n      for (i = 24; referenceCount; i += 12, referenceCount--) {\n        result.references.push({\n          referenceType: (data[i] & 0x80) >>> 7,\n          referencedSize: view.getUint32(i) & 0x7FFFFFFF,\n          subsegmentDuration: view.getUint32(i + 4),\n          startsWithSap: !!(data[i + 8] & 0x80),\n          sapType: (data[i + 8] & 0x70) >>> 4,\n          sapDeltaTime: view.getUint32(i + 8) & 0x0FFFFFFF\n        });\n      }\n\n      return result;\n    },\n    smhd: function(data) {\n      return {\n        version: data[0],\n        flags: new Uint8Array(data.subarray(1, 4)),\n        balance: data[4] + (data[5] / 256)\n      };\n    },\n    stbl: function(data) {\n      return {\n        boxes: inspectMp4(data)\n      };\n    },\n    stco: function(data) {\n      var\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n          version: data[0],\n          flags: new Uint8Array(data.subarray(1, 4)),\n          chunkOffsets: []\n        },\n        entryCount = view.getUint32(4),\n        i;\n      for (i = 8; entryCount; i += 4, entryCount--) {\n        result.chunkOffsets.push(view.getUint32(i));\n      }\n      return result;\n    },\n    stsc: function(data) {\n      var\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        entryCount = view.getUint32(4),\n        result = {\n          version: data[0],\n          flags: new Uint8Array(data.subarray(1, 4)),\n          sampleToChunks: []\n        },\n        i;\n      for (i = 8; entryCount; i += 12, entryCount--) {\n        result.sampleToChunks.push({\n          firstChunk: view.getUint32(i),\n          samplesPerChunk: view.getUint32(i + 4),\n          sampleDescriptionIndex: view.getUint32(i + 8)\n        });\n      }\n      return result;\n    },\n    stsd: function(data) {\n      return {\n        version: data[0],\n        flags: new Uint8Array(data.subarray(1, 4)),\n        sampleDescriptions: inspectMp4(data.subarray(8))\n      };\n    },\n    stsz: function(data) {\n      var\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n          version: data[0],\n          flags: new Uint8Array(data.subarray(1, 4)),\n          sampleSize: view.getUint32(4),\n          entries: []\n        },\n        i;\n      for (i = 12; i < data.byteLength; i += 4) {\n        result.entries.push(view.getUint32(i));\n      }\n      return result;\n    },\n    stts: function(data) {\n      var\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n          version: data[0],\n          flags: new Uint8Array(data.subarray(1, 4)),\n          timeToSamples: []\n        },\n        entryCount = view.getUint32(4),\n        i;\n\n      for (i = 8; entryCount; i += 8, entryCount--) {\n        result.timeToSamples.push({\n          sampleCount: view.getUint32(i),\n          sampleDelta: view.getUint32(i + 4)\n        });\n      }\n      return result;\n    },\n    styp: function(data) {\n      return parse.ftyp(data);\n    },\n    tfdt: function(data) {\n      var result = {\n        version: data[0],\n        flags: new Uint8Array(data.subarray(1, 4)),\n        baseMediaDecodeTime: data[4] << 24 | data[5] << 16 | data[6] << 8 | data[7]\n      };\n      if (result.version === 1) {\n        result.baseMediaDecodeTime *= Math.pow(2, 32);\n        result.baseMediaDecodeTime += data[8] << 24 | data[9] << 16 | data[10] << 8 | data[11];\n      }\n      return result;\n    },\n    tfhd: function(data) {\n      var\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        result = {\n          version: data[0],\n          flags: new Uint8Array(data.subarray(1, 4)),\n          trackId: view.getUint32(4)\n        },\n        baseDataOffsetPresent = result.flags[2] & 0x01,\n        sampleDescriptionIndexPresent = result.flags[2] & 0x02,\n        defaultSampleDurationPresent = result.flags[2] & 0x08,\n        defaultSampleSizePresent = result.flags[2] & 0x10,\n        defaultSampleFlagsPresent = result.flags[2] & 0x20,\n        durationIsEmpty = result.flags[0] & 0x010000,\n        defaultBaseIsMoof =  result.flags[0] & 0x020000,\n        i;\n\n      i = 8;\n      if (baseDataOffsetPresent) {\n        i += 4; // truncate top 4 bytes\n        // FIXME: should we read the full 64 bits?\n        result.baseDataOffset = view.getUint32(12);\n        i += 4;\n      }\n      if (sampleDescriptionIndexPresent) {\n        result.sampleDescriptionIndex = view.getUint32(i);\n        i += 4;\n      }\n      if (defaultSampleDurationPresent) {\n        result.defaultSampleDuration = view.getUint32(i);\n        i += 4;\n      }\n      if (defaultSampleSizePresent) {\n        result.defaultSampleSize = view.getUint32(i);\n        i += 4;\n      }\n      if (defaultSampleFlagsPresent) {\n        result.defaultSampleFlags = view.getUint32(i);\n      }\n      if (durationIsEmpty) {\n        result.durationIsEmpty = true;\n      }\n      if (!baseDataOffsetPresent && defaultBaseIsMoof) {\n        result.baseDataOffsetIsMoof = true;\n      }\n      return result;\n    },\n    tkhd: function(data) {\n      var\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        i = 4,\n        result = {\n          version: view.getUint8(0),\n          flags: new Uint8Array(data.subarray(1, 4))\n        };\n      if (result.version === 1) {\n        i += 4;\n        result.creationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n        i += 8;\n        result.modificationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n        i += 4;\n        result.trackId = view.getUint32(i);\n        i += 4;\n        i += 8;\n        result.duration = view.getUint32(i); // truncating top 4 bytes\n      } else {\n        result.creationTime = parseMp4Date(view.getUint32(i));\n        i += 4;\n        result.modificationTime = parseMp4Date(view.getUint32(i));\n        i += 4;\n        result.trackId = view.getUint32(i);\n        i += 4;\n        i += 4;\n        result.duration = view.getUint32(i);\n      }\n      i += 4;\n      i += 2 * 4;\n      result.layer = view.getUint16(i);\n      i += 2;\n      result.alternateGroup = view.getUint16(i);\n      i += 2;\n      // convert fixed-point, base 16 back to a number\n      result.volume = view.getUint8(i) + (view.getUint8(i + 1) / 8);\n      i += 2;\n      i += 2;\n      result.matrix = new Uint32Array(data.subarray(i, i + (9 * 4)));\n      i += 9 * 4;\n      result.width = view.getUint16(i) + (view.getUint16(i + 2) / 16);\n      i += 4;\n      result.height = view.getUint16(i) + (view.getUint16(i + 2) / 16);\n      return result;\n    },\n    traf: function(data) {\n      return {\n        boxes: inspectMp4(data)\n      };\n    },\n    trak: function(data) {\n      return {\n        boxes: inspectMp4(data)\n      };\n    },\n    trex: function(data) {\n      var view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n      return {\n        version: data[0],\n        flags: new Uint8Array(data.subarray(1, 4)),\n        trackId: view.getUint32(4),\n        defaultSampleDescriptionIndex: view.getUint32(8),\n        defaultSampleDuration: view.getUint32(12),\n        defaultSampleSize: view.getUint32(16),\n        sampleDependsOn: data[20] & 0x03,\n        sampleIsDependedOn: (data[21] & 0xc0) >> 6,\n        sampleHasRedundancy: (data[21] & 0x30) >> 4,\n        samplePaddingValue: (data[21] & 0x0e) >> 1,\n        sampleIsDifferenceSample: !!(data[21] & 0x01),\n        sampleDegradationPriority: view.getUint16(22)\n      };\n    },\n    trun: function(data) {\n      var\n        result = {\n          version: data[0],\n          flags: new Uint8Array(data.subarray(1, 4)),\n          samples: []\n        },\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        // Flag interpretation\n        dataOffsetPresent = result.flags[2] & 0x01, // compare with 2nd byte of 0x1\n        firstSampleFlagsPresent = result.flags[2] & 0x04, // compare with 2nd byte of 0x4\n        sampleDurationPresent = result.flags[1] & 0x01, // compare with 2nd byte of 0x100\n        sampleSizePresent = result.flags[1] & 0x02, // compare with 2nd byte of 0x200\n        sampleFlagsPresent = result.flags[1] & 0x04, // compare with 2nd byte of 0x400\n        sampleCompositionTimeOffsetPresent = result.flags[1] & 0x08, // compare with 2nd byte of 0x800\n        sampleCount = view.getUint32(4),\n        offset = 8,\n        sample;\n\n      if (dataOffsetPresent) {\n        // 32 bit signed integer\n        result.dataOffset = view.getInt32(offset);\n        offset += 4;\n      }\n\n      // Overrides the flags for the first sample only. The order of\n      // optional values will be: duration, size, compositionTimeOffset\n      if (firstSampleFlagsPresent && sampleCount) {\n        sample = {\n          flags: parseSampleFlags(data.subarray(offset, offset + 4))\n        };\n        offset += 4;\n        if (sampleDurationPresent) {\n          sample.duration = view.getUint32(offset);\n          offset += 4;\n        }\n        if (sampleSizePresent) {\n          sample.size = view.getUint32(offset);\n          offset += 4;\n        }\n        if (sampleCompositionTimeOffsetPresent) {\n          // Note: this should be a signed int if version is 1\n          sample.compositionTimeOffset = view.getUint32(offset);\n          offset += 4;\n        }\n        result.samples.push(sample);\n        sampleCount--;\n      }\n\n      while (sampleCount--) {\n        sample = {};\n        if (sampleDurationPresent) {\n          sample.duration = view.getUint32(offset);\n          offset += 4;\n        }\n        if (sampleSizePresent) {\n          sample.size = view.getUint32(offset);\n          offset += 4;\n        }\n        if (sampleFlagsPresent) {\n          sample.flags = parseSampleFlags(data.subarray(offset, offset + 4));\n          offset += 4;\n        }\n        if (sampleCompositionTimeOffsetPresent) {\n          // Note: this should be a signed int if version is 1\n          sample.compositionTimeOffset = view.getUint32(offset);\n          offset += 4;\n        }\n        result.samples.push(sample);\n      }\n      return result;\n    },\n    'url ': function(data) {\n      return {\n        version: data[0],\n        flags: new Uint8Array(data.subarray(1, 4))\n      };\n    },\n    vmhd: function(data) {\n      var view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n      return {\n        version: data[0],\n        flags: new Uint8Array(data.subarray(1, 4)),\n        graphicsmode: view.getUint16(4),\n        opcolor: new Uint16Array([view.getUint16(6),\n                                  view.getUint16(8),\n                                  view.getUint16(10)])\n      };\n    }\n  };\n\n\n/**\n * Return a javascript array of box objects parsed from an ISO base\n * media file.\n * @param data {Uint8Array} the binary data of the media to be inspected\n * @return {array} a javascript array of potentially nested box objects\n */\ninspectMp4 = function(data) {\n  var\n    i = 0,\n    result = [],\n    view,\n    size,\n    type,\n    end,\n    box;\n\n  // Convert data from Uint8Array to ArrayBuffer, to follow Dataview API\n  var ab = new ArrayBuffer(data.length);\n  var v = new Uint8Array(ab);\n  for (var z = 0; z < data.length; ++z) {\n      v[z] = data[z];\n  }\n  view = new DataView(ab);\n\n  while (i < data.byteLength) {\n    // parse box data\n    size = view.getUint32(i);\n    type =  parseType(data.subarray(i + 4, i + 8));\n    end = size > 1 ? i + size : data.byteLength;\n\n    // parse type-specific data\n    box = (parse[type] || function(data) {\n      return {\n        data: data\n      };\n    })(data.subarray(i + 8, end));\n    box.size = size;\n    box.type = type;\n\n    // store this box and move to the next\n    result.push(box);\n    i = end;\n  }\n  return result;\n};\n\n/**\n * Returns a textual representation of the javascript represtentation\n * of an MP4 file. You can use it as an alternative to\n * JSON.stringify() to compare inspected MP4s.\n * @param inspectedMp4 {array} the parsed array of boxes in an MP4\n * file\n * @param depth {number} (optional) the number of ancestor boxes of\n * the elements of inspectedMp4. Assumed to be zero if unspecified.\n * @return {string} a text representation of the parsed MP4\n */\ntextifyMp4 = function(inspectedMp4, depth) {\n  var indent;\n  depth = depth || 0;\n  indent = new Array(depth * 2 + 1).join(' ');\n\n  // iterate over all the boxes\n  return inspectedMp4.map(function(box, index) {\n\n    // list the box type first at the current indentation level\n    return indent + box.type + '\\n' +\n\n      // the type is already included and handle child boxes separately\n      Object.keys(box).filter(function(key) {\n        return key !== 'type' && key !== 'boxes';\n\n      // output all the box properties\n      }).map(function(key) {\n        var prefix = indent + '  ' + key + ': ',\n            value = box[key];\n\n        // print out raw bytes as hexademical\n        if (value instanceof Uint8Array || value instanceof Uint32Array) {\n          var bytes = Array.prototype.slice.call(new Uint8Array(value.buffer, value.byteOffset, value.byteLength))\n              .map(function(byte) {\n                return ' ' + ('00' + byte.toString(16)).slice(-2);\n              }).join('').match(/.{1,24}/g);\n          if (!bytes) {\n            return prefix + '<>';\n          }\n          if (bytes.length === 1) {\n            return prefix + '<' + bytes.join('').slice(1) + '>';\n          }\n          return prefix + '<\\n' + bytes.map(function(line) {\n            return indent + '  ' + line;\n          }).join('\\n') + '\\n' + indent + '  >';\n        }\n\n        // stringify generic objects\n        return prefix +\n            JSON.stringify(value, null, 2)\n              .split('\\n').map(function(line, index) {\n                if (index === 0) {\n                  return line;\n                }\n                return indent + '  ' + line;\n              }).join('\\n');\n      }).join('\\n') +\n\n    // recursively textify the child boxes\n    (box.boxes ? '\\n' + textifyMp4(box.boxes, depth + 1) : '');\n  }).join('\\n');\n};\n\nmodule.exports = {\n  inspect: inspectMp4,\n  textify: textifyMp4,\n  parseTfdt: parse.tfdt,\n  parseHdlr: parse.hdlr,\n  parseTfhd: parse.tfhd,\n  parseTrun: parse.trun,\n  parseSidx: parse.sidx\n};\n"]},"metadata":{},"sourceType":"script"}